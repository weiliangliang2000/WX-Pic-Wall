"use strict";const e=require("../../common/vendor.js");require("../../utils/system.js");const o=require("../../utils/request.js"),a={__name:"classlist",setup(a){let t=1;const r=e.ref(""),s=e.ref([]);function n(a=!1){(function(a={}){return new Promise(((t,r)=>{let{data:s={},method:n="GET",header:i={}}=a;e.index.request({url:o.url+"wallpapers",method:n,header:i,data:s,success:function(o){200===o.statusCode?t(o.data):(console.error("Error:",o.data.message),e.index.showToast({title:"没有更多图片了...",icon:"none",duration:2e3}),r(o.data.message))},fail:function(o){console.error("Request failed:",o),e.index.showToast({title:"Request failed",icon:"none",duration:3e3}),r(o)}})}))})({data:{page:t,category_id:r.value}}).then((e=>{s.value=a?e:[...s.value,...e],t++,console.log(t)})).catch((e=>{console.error("Failed to load images:",e)}))}return e.onLoad((e=>{r.value=parseInt(e.id,10),console.log(r.value),n(!0)})),e.onReachBottom((()=>{console.log("触底加载更多..."),n()})),(o,a)=>({a:e.f(s.value,((o,a,t)=>({a:o.image_url,b:e.o((a=>{return t=o.id,e.index.setStorageSync("pic",s.value),void e.index.navigateTo({url:"/pages/preview/preview?id="+t});var t}),o.id),c:o.id})))})}},t=e._export_sfc(a,[["__scopeId","data-v-2cd36369"]]);wx.createPage(t);
