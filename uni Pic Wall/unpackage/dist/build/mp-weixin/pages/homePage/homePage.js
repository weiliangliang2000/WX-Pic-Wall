"use strict";const e=require("../../common/vendor.js"),o=require("../../utils/system.js"),a=require("../../utils/request.js");if(!Array){(e.resolveComponent("uni-load-more")+e.resolveComponent("uni-segmented-control")+e.resolveComponent("uni-fab"))()}Math||((()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../uni_modules/uni-segmented-control/components/uni-segmented-control/uni-segmented-control.js")+(()=>"../../uni_modules/uni-fab/components/uni-fab/uni-fab.js"))();const t={__name:"homePage",setup(t){const n=e.ref({pattern:{icon:"arrow-up",buttonColor:"#34464F"},content:[],horizontal:"right",vertical:"bottom",direction:"up"});let l=e.ref(0);function i(){e.index.pageScrollTo({scrollTop:0,duration:300}),l.value=0}const r=e.ref(["每日推荐","热门精选","可爱萌宠","AI美图","自然风景"]),s=e.ref(0),u=e.ref([]);let c=1;const d=e.ref([]);let p=1;const g=e.ref([]);let v=1;const f=e.ref([]);let m=1,h=0;function x(e){h=e.currentIndex,s.value!==h&&(s.value=h,l.value=0),1==s.value&&(c=1,w(!0)),2==s.value&&(p=1,_(!0)),3==s.value&&(v=1,S(!0)),4==s.value&&(m=1,b(!0))}function w(e=!1){F({data:{page:c,hot:"true"}}).then((o=>{u.value=e?o:[...u.value,...o],c++,console.log(c)})).catch((e=>{console.error("Failed to load images:",e)}))}function _(e=!1){F({data:{page:p,category_id:6}}).then((o=>{d.value=e?o:[...d.value,...o],p++,console.log(p)})).catch((e=>{console.error("Failed to load images:",e)}))}function S(e=!1){F({data:{page:v,category_id:4}}).then((o=>{g.value=e?o:[...g.value,...o],v++,console.log(v)})).catch((e=>{console.error("Failed to load images:",e)}))}function b(e=!1){F({data:{page:m,category_id:1}}).then((o=>{f.value=e?o:[...f.value,...o],m++,console.log(m)})).catch((e=>{console.error("Failed to load images:",e)}))}function y(){console.log("缓存热门精选"),e.index.setStorageSync("pic",u.value)}function q(){console.log("缓存每日推荐"),e.index.setStorageSync("pic",j.value)}function T(){console.log("缓存可爱萌宠"),e.index.setStorageSync("pic",d.value)}function C(){console.log("缓存AI美图"),e.index.setStorageSync("pic",g.value)}function I(){console.log("缓存自然风景"),e.index.setStorageSync("pic",f.value)}e.onReachBottom((()=>{console.log("触底加载更多..."),1==h&&(console.log("热门精选"),w(),l.value++),2==h&&(console.log("可爱萌宠"),_(),l.value++),3==h&&(console.log("AI美图"),S(),l.value++),4==h&&(console.log("自然风景"),b(),l.value++)}));const j=e.ref([]);function F(o={}){return new Promise(((t,n)=>{let{data:l={},method:i="GET",header:r={}}=o;e.index.request({url:a.url+"wallpapers",method:i,header:r,data:l,success:function(o){200===o.statusCode?t(o.data):(console.error("Error:",o.data.message),e.index.showToast({title:"没有更多图片了...",icon:"none",duration:2e3}),n(o.data.message))},fail:function(o){console.error("Request failed:",o),e.index.showToast({title:"Request failed",icon:"none",duration:3e3}),n(o)}})}))}e.index.request({url:a.url+"wallpapers",method:"GET",data:{random:"true"},success:function(o){200===o.statusCode?(console.log("Random Wallpapers:",o.data),j.value=o.data):(console.error("Error:",o.data.message),e.index.showToast({title:"Failed to load wallpapers",icon:"none",duration:3e3}))},fail:function(o){console.error("Request failed:",o),e.index.showToast({title:"Request failed",icon:"none",duration:3e3})}});const P=e.ref([]);return e.index.request({url:"https://api.oioweb.cn/api/bing",success:e=>{P.value=e.data.result,console.log("bannnerlist:",e.data.result)},fail:o=>{e.index.showToast({title:"轮播图请求错误，请联系作者",icon:"none",duration:3e3})}}),e.onShareAppMessage((e=>({title:"Pic-Wall",path:"/pages/index/login"}))),e.onShareTimeline((()=>({title:"Pic-Wall",path:"/pages/index/index",query:"id="+currentId.value+"&type=share"}))),e.index.request({url:"https://httpbin.org/ip",success:o=>{console.log(o),e.index.setStorageSync("ip",o.data.origin),console.log("IP:",o.data.origin),e.index.request({url:"https://api.oioweb.cn/api/ip/ipaddress?ip="+o.data.origin,success:o=>{e.index.setStorageSync("ip_adress",o.data.result.addr[0]),console.log("ip地址:",o.data.result.addr[0])}})},fail:e=>{console.error("获取公网IP失败:",e)}}),e.index.request({url:a.url+"random_category_wallpapers",method:"GET",success:o=>{200===o.statusCode?(e.index.setStorageSync("nine",o.data),console.log("随机获取的9类壁纸数据:",o.data)):(console.error("获取壁纸数据失败:",o.data.message),e.index.showToast({title:"获取壁纸数据失败",icon:"none"}))},fail:o=>{console.error("请求失败:",o),e.index.showToast({title:"请求失败",icon:"none"})}}),(a,t)=>e.e({a:e.unref(o.getStatusBarHeight)()+"px",b:e.unref(o.getTitleBarHeight)()+"px",c:e.f(P.value,((e,o,a)=>({a:e.url,b:o}))),d:!j.value.length},j.value.length?{}:{e:e.p({status:"loading"})},{f:e.o(x),g:e.p({current:s.value,values:r.value,styleType:"text",activeColor:"#23ABF2"}),h:0===s.value},0===s.value?{i:e.f(j.value,((o,a,t)=>({a:o.image_url,b:"/pages/preview/preview?id="+o.id,c:o.id,d:e.o(q,o.id)})))}:{},{j:1===s.value},1===s.value?{k:e.f(u.value,((o,a,t)=>({a:o.image_url,b:"/pages/preview/preview?id="+o.id,c:o.id,d:e.o(y,o.id)})))}:{},{l:2===s.value},2===s.value?{m:e.f(d.value,((o,a,t)=>({a:o.image_url,b:"/pages/preview/preview?id="+o.id,c:o.id,d:e.o(T,o.id)})))}:{},{n:3===s.value},3===s.value?{o:e.f(g.value,((o,a,t)=>({a:o.image_url,b:"/pages/preview/preview?id="+o.id,c:o.id,d:e.o(C,o.id)})))}:{},{p:4===s.value},4===s.value?{q:e.f(f.value,((o,a,t)=>({a:o.image_url,b:"/pages/preview/preview?id="+o.id,c:o.id,d:e.o(I,o.id)})))}:{},{r:e.unref(l)>=2},e.unref(l)>=2?{s:e.o(i),t:e.p({pattern:n.value.pattern,horizontal:n.value.horizontal,vertical:n.value.vertical,direction:n.value.direction,popMenu:!1})}:{})}},n=e._export_sfc(t,[["__scopeId","data-v-68527144"]]);t.__runtimeHooks=6,wx.createPage(n);
